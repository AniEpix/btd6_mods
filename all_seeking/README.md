remake of the old version which no longer works
